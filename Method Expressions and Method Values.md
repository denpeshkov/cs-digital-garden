---
tags:
  - Go
---

# Method Expressions

If `M` is in the [method set](https://go.dev/ref/spec#Method_sets) of type `T`, `T.M` is a function that is callable as a regular function with the same arguments as `M` prefixed by an additional argument that is the receiver of the method

For example, given:

```go
type T struct {
	a int
}
func (tv  T) Mv(a int) int         { return 0 }  // value receiver
func (tp *T) Mp(f float32) float32 { return 1 }  // pointer receiver
```

- `T.Mv` yields a function with signature `func(tv T, a int) int`
- `(*T).Mp` yields a function with signature `func(tp *T, f float32) float32`
- `(*T).Mv` yields a function with signature `func(tv *T, a int) int`. This function indirects through the receiver to create a value to pass as the receiver to the underlying method
- `T.Mp` is illegal, because pointer-receiver methods are not in the method set of the value type

It is legal to derive a function value from a method of an interface type. The resulting function takes an explicit receiver of that interface type

# Method Values

If the expression `x` has static type `T` and `M` is in the [method set](https://go.dev/ref/spec#Method_sets) of type `T`, the **method value** `x.M` is a function value that is callable with the same arguments as a method call of `x.M`

The expression `x` is evaluated and saved during the evaluation of the method value; the saved copy is then used as the receiver in any calls, which may be executed later

For example, given:

```go
type T struct {
	a int
}
func (tv  T) Mv(a int) int         { return 0 }  // value receiver
func (tp *T) Mp(f float32) float32 { return 1 }  // pointer receiver

var t T
var pt *T
```

- `t.Mv` yields a function value of type `func(int) int`
- `pt.Mp` yields a function value of type `func(float32) float32`
- `pt.Mv` is equivalent to `(*pt).Mv`
- `t.Mp` is equivalent to `(&t).Mp` if `t` is [addressable](https://go.dev/ref/spec#Address_operators)

# Implementation

Function values are pointers that point to structs. These structs contain either:

1. Just the pointer to the function code for simple functions
2. Two pointers to autogenerated wrapper functions and receivers and/or function parameters in the case of method calls and closures

# References

- [The Go Programming Language Specification - The Go Programming Language](https://go.dev/ref/spec#Method_expressions)
- [The Go Programming Language Specification - The Go Programming Language](https://go.dev/ref/spec#Method_values)
- [What is a Go function variable? · Phil Pearl's Blog](https://philpearl.github.io/post/functionpointers/)
